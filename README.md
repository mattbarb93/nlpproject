After adding a setTimeout, the function finally behaves properly. 

Now, currently working on the test files, and installing the proper modules to make it work
